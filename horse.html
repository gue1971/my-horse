<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>My Stable – 馬詳細</title>

<head>
  <style>
    /* すべての要素のCSSをリセット */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html {
      height: 100%;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      font-size: 16px; /* 基本フォントサイズ */
    }

    /* ヘッダー */
    .header {
      position: sticky;
      top: 0;
      background: #111;
      border-bottom: 1px solid var(--line);
      display: flex;
      align-items: center;
      padding-left: 4px;
      height: 40px; /* 固定高さ */
    }

    .header h1 {
      font-size: 16px;
      font-weight: normal;
      text-align: left;
      flex-grow: 1;
    }

    /* ヒーロー画像 */
    .hero img {
      width: 100%;
      height: auto;
      object-fit: cover;
    }

    .hero .one-line {
      font-size: 12px; /* one-lineのサイズ */
      color: var(--muted);
      padding: 8px 0;
    }

    /* プロフィール */
    .profile {
      background: #222;
      border: 1px solid #333;
      padding: 12px;
      border-radius: 8px;
      margin-top: 12px;
    }

    .horse-name {
      font-size: 18px; /* 馬名のサイズ */
      font-weight: bold;
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .horse-name img {
      width: 20px;
      height: 20px;
      margin-right: 8px;
      object-fit: contain;
    }

    /* プロフィール項目 */
    .profile .cell {
      display: flex;
      gap: 8px;
      font-size: 16px;  /* 文字サイズ16pxに固定 */
      margin-bottom: 4px;
    }

    .profile .label {
      font-weight: bold;
      min-width: 70px;
    }

    /* コメント */
    .comments .comment {
      margin-bottom: 12px;
      padding: 8px;
      background: #222;
      border: 1px solid #333;
      border-radius: 6px;
      font-size: 16px; /* コメント部分のフォントサイズ */
    }

    .comments .date {
      font-size: 12px;
      color: var(--muted);
    }

  </style>
</head>

<body>
  <header class="header">
    <h1>プロフィール</h1>
  </header>

  <main class="main">
    <div class="content">
      <!-- ヒーロー -->
      <section class="hero" id="hero">
        <img src="images/slug/hero.jpg" alt="ヒーロー画像">
        <div class="one-line" id="hero-caption"></div>
      </section>

      <!-- プロフィール -->
      <section class="profile" id="profile">
        <div class="horse-name" id="horse-name">
          <img src="path/to/club-icon.gif" alt="クラブアイコン" id="club-icon">
          <span id="horse-name-text"></span>
        </div>

        <div class="cell"><span class="label">父</span><span id="sire"></span></div>
        <div class="cell"><span class="label">母</span><span id="dam"></span></div>
        <div class="cell"><span class="label">母父</span><span id="damsire"></span></div>
        <div class="cell"><span class="label">生産</span><span id="farm"></span></div>
        <div class="cell"><span class="label">厩舎</span><span id="stable"></span></div>
        <div class="cell"><span class="label">生年月日</span><span id="birth"></span></div>
        <div class="cell"><span class="label">募集総額</span><span id="price"></span></div>

        <div class="cell"><span class="label">即尺</span><span id="height"></span><span id="girth"></span><span id="cannon"></span><span id="weight"></span></div>
      </section>

      <!-- コメント -->
      <section class="comments" id="comments"></section>
    </div>
  </main>

  <script>
    const clubIcon = {
      carrot: 'assets/icons/clubs/carrot.gif',
      silk: 'assets/icons/clubs/silk.gif',
      tokyo: 'assets/icons/clubs/tokyo.gif',
      win: 'assets/icons/clubs/win.gif',
      union: 'assets/icons/clubs/union.gif',
      normandy: 'assets/icons/clubs/normandy.gif',
    };

    function getParam(name){ return new URLSearchParams(location.search).get(name) || ''; }

    (async function(){
      const slug = (getParam('id') || getParam('slug') || '').trim().toLowerCase();
      const horses = await (await fetch('data/horses.json')).json();
      const horse = horses.find(h=> (h.slug||'').toLowerCase()===slug);
      if(!horse) return;

      const detail = await (await fetch(`data/albums/${slug}.json`)).json();

      // ヘッダー画像キャプション
      const heroCaption = detail.album?.find(a=>a.isHero)?.caption || '';
      document.getElementById('hero-caption').textContent = heroCaption;

      // 馬名とクラブアイコン
      document.getElementById('horse-name-text').textContent = horse.name || '';
      document.getElementById('club-icon').src = clubIcon[horse.club] || clubIcon.carrot;

      // プロフィール値
      document.getElementById('sire').textContent = horse.sire || '';
      document.getElementById('dam').textContent = horse.dam || '';
      document.getElementById('damsire').textContent = horse.damsire || '';
      document.getElementById('farm').textContent = horse.farm || '';
      document.getElementById('stable').textContent = horse.stable || '';
      document.getElementById('birth').textContent = horse.birth || '';
      document.getElementById('price').textContent = horse.price || '';

      // 測尺
      const M = detail.measure || {};
      document.getElementById('height').textContent = `体高 ${M.height_cm || ''}cm`;
      document.getElementById('girth').textContent = `胸囲 ${M.girth_cm || ''}cm`;
      document.getElementById('cannon').textContent = `管囲 ${M.cannon_cm || ''}cm`;
      document.getElementById('weight').textContent = `馬体重 ${M.weight_kg || ''}kg`;

      // コメント
      const comments = detail.archiveComment || [];
      const commentsHTML = comments.map(c=>`
        <div class="comment">
          <div class="date">${c.date}</div>
          <div class="title">${c.title}</div>
          <div class="text">${c.text}</div>
        </div>`).join('');
      document.getElementById('comments').innerHTML = commentsHTML;
    })();
  </script>

</body>
</html>
